The naive function is not using asynchronous in looping.
It will be fine if your data is not big.
But there is S3 function that can need more time to wait instead of generate local log.